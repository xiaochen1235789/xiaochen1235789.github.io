<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Èü≥‰πêÊí≠ÊîæÂô®ÔºàÊúÄÁªàÂÆåÂñÑÁâàÔºâ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft YaHei", sans-serif; }
        body { background: transparent; padding: 0; margin: 0; height: 100%; overflow: hidden; }
        .player-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 99999;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-top: 10px;
            transition: all 0.3s ease;
            width: 100%;
        }
        .player-mini-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #1e3a2f;
            border: 1px solid #3d725f;
            color: #81c784;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            display: none;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }
        .mini-music-player {
            width: 100% !important;
            max-width: 100% !important;
            min-width: 300px;
            height: 60px;
            background: #1e3a2f;
            padding: 6px 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 8px 8px 0 0;
            border: 1px solid #3d725f;
            border-bottom: none;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.3);
            cursor: move;
            user-select: none;
            -webkit-user-drag: none;
            position: relative;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            overflow: visible !important;
        }
        .player-cover {
            width: 44px;
            height: 44px;
            border-radius: 4px;
            background: #2d5243;
            overflow: hidden;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }
        .player-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
            transition: transform 0.5s ease;
        }
        .mini-music-player.playing .player-cover img { transform: rotate(360deg); }
        .player-info {
            flex: 0 0 180px;
            flex-shrink: 0;
            pointer-events: none;
        }
        .player-title {
            font-size: 0.9rem;
            color: #81c784;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.2s ease;
        }
        .player-singer {
            font-size: 0.75rem;
            color: #99aabb;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .player-controls { display: flex; align-items: center center; gap: 8px; }
        .player-btn {
            background: transparent;
            border: none;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 1rem;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            pointer-events: auto !important;
        }
        .play-main-btn { background: #81c784; color: #121212; font-weight: bold; }
        .player-volume { flex: 0 0 32px; display: flex; align-items: center; flex-shrink: 0; }
        .volume-btn {
            background: transparent;
            border: none;
            color: #99aabb;
            cursor: pointer;
            font-size: 0.9rem;
            z-index: 10;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            pointer-events: auto !important;
        }
        .toggle-btn {
            background: transparent;
            border: none;
            color: #99aabb;
            cursor: pointer;
            font-size: 0.9rem;
            flex-shrink: 0;
            z-index: 10;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            margin-left: 8px;
            padding: 0 8px;
            pointer-events: auto !important;
        }
        #listToggleBtn { margin-left: auto; }
        .player-progress {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100%;
            padding: 4px 2%;
            background: #1e3a2f;
            border-radius: 4px 4px 0 0;
            border-bottom: 1px solid #3d725f;
            box-sizing: border-box;
            min-height: 24px;
            transition: all 0.2s ease;
            z-index: 1;
        }
        .mini-music-player:hover .player-progress { display: block; }
        .progress-bar-mini {
            width: 100%;
            height: 3px;
            background: #2d5243;
            border-radius: 2px;
            position: relative;
            cursor: pointer;
            transition: height 0.2s ease;
        }
        .progress-mini {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0%;
            background: #81c784;
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        .time-mini {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #99aabb;
            margin-top: 2px;
            width: 100%;
        }
        .song-list-container {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100% !important;
            max-height: 300px;
            overflow-y: auto;
            background: #1e3a2f;
            border: 1px solid #3d725f;
            border-bottom: none;
            border-radius: 4px 4px 0 0;
            padding: 8px 0;
            z-index: 10;
        }
        .song-list-container.show { display: block !important; }
        .song-list { list-style: none; }
        .song-list li {
            padding: 8px 16px;
            color: #e0e0e0;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.2s;
            pointer-events: auto;
            -webkit-tap-highlight-color: transparent;
        }
        .song-list li.active { background: #2d5243; color: #81c784; font-weight: 500; }
        .page-controls {
            display: flex;
            justify-content: center;
            padding: 8px 0;
            border-top: 1px solid #3d725f;
        }
        .page-btn {
            background: transparent;
            border: 1px solid #81c784;
            color: #81c784;
            padding: 4px 12px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 4px;
            transition: all 0.2s ease;
        }
        .page-btn:disabled {
            border-color: #2d5243;
            color: #2d5243;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="player-container" id="playerContainer">
        <button class="player-mini-btn" id="playerMiniBtn">‚ñ∂</button>
        <div class="mini-music-player" id="draggablePlayer">
            <div class="player-cover" id="playerCover1">
                <img src="http://p2.music.126.net/BKJrPO1FlbXcy-98AYXOzg==/109951172268004943.jpg?param=300x300" alt="ÊòîÊ∂ü">
            </div>
            <div class="player-cover" id="playerCover2" style="display:none;">
                <img src="http://p2.music.126.net/DYDACa_8zB5irAOrasVgnQ==/109951171396677694.jpg?param=300x300" alt="ËÄÄÊñë">
            </div>
            <div class="player-cover" id="playerCover3" style="display:none;">
                <img src="http://p2.music.126.net/2qGGwWFlMYF2o-GyNMhH5A==/109951171066942237.jpg?param=300x300" alt="ÊãÇÊôì">
            </div>
            <div class="player-cover" id="playerCover4" style="display:none;">
                <img src="http://p1.music.126.net/gtunmoxObQyoH01HzURNUw==/109951170292455448.jpg?param=300x300" alt="‰ΩïËÄÖ">
            </div>
            <div class="player-cover" id="playerCover5" style="display:none;">
                <img src="http://p1.music.126.net/jWx1g4PbZsIu9npNOlifzA==/109951170151255339.jpg?param=300x300" alt="Áù°Ëïâ‰πãÊ≠å">
            </div>
            <div class="player-cover" id="playerCover6" style="display:none;">
                <img src="http://p1.music.126.net/sZ-rACbFrybF0x_lI6XNMw==/109951169297766755.jpg?param=300x300" alt="‰∏çÁú†‰πãÂ§ú">
            </div>
            <div class="player-cover" id="playerCover7" style="display:none;">
                <img src="http://p1.music.126.net/arz1hBaMCVcVV3yktxpoGg==/109951172346365107.jpg?param=300x300" alt="Montagem Miau">
            </div>
            <div class="player-cover" id="playerCover8" style="display:none;">
                <img src="http://p1.music.126.net/ykljhikl5x5QXgYjiIvW8g==/109951163082689392.jpg?param=300x300" alt="Áå´ÁöÑËàûÊ≠•">
            </div>
            <div class="player-cover" id="playerCover9" style="display:none;">
                <img src="http://p2.music.126.net/6y-UleORITEDfD5K8I44Qw==/109951165493980841.jpg?param=300x300" alt="Á§∫‰æãÊ≠åÊõ≤9">
            </div>

            <div class="player-info">
                <div class="player-title" id="playerTitle">ÊòîÊ∂ü</div>
                <div class="player-singer" id="playerSinger">Âº†Èü∂Ê∂µ„ÄÅHOYO-MiX</div>
            </div>
            <div class="player-controls">
                <button class="player-btn" id="miniPrevBtn">‚ùÆ</button>
                <button class="player-btn play-main-btn" id="miniPlayBtn">‚ñ∂</button>
                <button class="player-btn" id="miniNextBtn">‚ùØ</button>
            </div>
            <div class="player-volume">
                <button class="volume-btn" id="volumeBtn">üîä</button>
            </div>
            <button class="toggle-btn" id="listToggleBtn">üìú Ê≠åÊõ≤ÂàóË°®</button>
            <button class="toggle-btn" id="toggleBtn">„Äê<„ÄëÊî∂Ëµ∑ </button>
            
            <div class="player-progress">
                <div class="progress-bar-mini" id="miniProgressBar">
                    <div class="progress-mini" id="miniProgress"></div>
                </div>
                <div class="time-mini">
                    <span class="current-time-mini" id="currentTime">00:00</span>
                    <span class="total-time-mini" id="totalTime">03:06</span>
                </div>
            </div>
            
            <div class="song-list-container" id="songListContainer">
                <ul class="song-list" id="songList"></ul>
            </div>
        </div>

        <audio id="miniAudio1" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=3316968660.mp3" type="audio/mpeg">
       </audio>
        <audio id="miniAudio2" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=2722510685.mp3" type="audio/mpeg">
       <RichMediaReference>
        <audio id="miniAudio3" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=2709812973.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio4" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=2658660685.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio5" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=2646986980.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio6" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=2122308127.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio7" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=3320816993.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio8" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=523902194.mp3" type="audio/mpeg">
        <<|card|>:
        <audio id="miniAudio9" preload="none" playsinline>
            <source src="http://music.163.com/song/media/outer/url?id=1428234445.mp3" type="audio/mpeg">
        <<|card|>:
    </div>

    <script>
        // ÂÖÉÁ¥†ÂàùÂßãÂåñ
        const playerContainer = document.getElementById('playerContainer');
        const draggablePlayer = document.getElementById('draggablePlayer');
        const playBtn = document.getElementById('miniPlayBtn');
        const toggleBtn = document.getElementById('toggleBtn');
        const playerMiniBtn = document.getElementById('playerMiniBtn');
        const progress = document.getElementById('miniProgress');
        const currentTimeEl = document.getElementById('currentTime');
        const totalTimeEl = document.getElementById('totalTime');
        const volumeBtn = document.getElementById('volumeBtn');
        const prevBtn = document.getElementById('miniPrevBtn');
        const nextBtn = document.getElementById('miniNextBtn');
        const playerTitle = document.getElementById('playerTitle');
        const playerSinger = document.getElementById('playerSinger');
        const listToggleBtn = document.getElementById('listToggleBtn');
        const songListContainer = document.getElementById('songListContainer');
        const songListEl = document.getElementById('songList');

        // Ê≠åÊõ≤ÂàóË°®
        const songList = [
            { audioId: 'miniAudio1', coverId: 'playerCover1', title: 'ÊòîÊ∂ü', singer: 'Âº†Èü∂Ê∂µ„ÄÅHOYO-MiX', defaultDuration: '03:06' },
            { audioId: 'miniAudio2', coverId: 'playerCover2', title: 'ËÄÄÊñë', singer: 'HOYO-MiX,YMIR', defaultDuration: '03:33' },
            { audioId: 'miniAudio3', coverId: 'playerCover3', title: 'ÊãÇÊôì Proi Proi', singer: 'HOYO-MiX,NIDA', defaultDuration: '03:58' },
            { audioId: 'miniAudio4', coverId: 'playerCover4', title: '‰ΩïËÄÖ', singer: 'Ë∞≠Êô∂,HOYO-MiX', defaultDuration: '02:26' },
            { audioId: 'miniAudio5', coverId: 'playerCover5', title: 'Áù°Ëïâ‰πãÊ≠å', singer: 'HOYO-MiX', defaultDuration: '00:17' },
            { audioId: 'miniAudio6', coverId: 'playerCover6', title: '‰∏çÁú†‰πãÂ§ú', singer: 'Âº†Êù∞,HOYO-MiX', defaultDuration: '02:18' },
            { audioId: 'miniAudio7', coverId: 'playerCover7', title: 'Montagem Miau', singer: 'Pudding_PD,METAMOON', defaultDuration: '02:19' },
            { audioId: 'miniAudio8', coverId: 'playerCover8', title: 'Áå´ÁöÑËàûÊ≠•', singer: 'Candy_Wind', defaultDuration: '03:07' },
            { audioId: 'miniAudio9', coverId: 'playerCover9', title: 'Á§∫‰æãÊ≠åÊõ≤9', singer: 'Ê≠åÊâã9', defaultDuration: '03:20' }
        ];

        // ÂàÜÈ°µÈÖçÁΩÆ
        const PAGE_SIZE = 6;
        let currentPage = 1;
        const totalPages = Math.ceil(songList.length / PAGE_SIZE);

        // ÂÖ®Â±ÄÁä∂ÊÄÅ
        let currentSongIndex = 0;
        let isDragging = false;
        let playState = { isExpanded: true, isPlaying: false };
        let currentAudio = document.getElementById(songList[currentSongIndex].audioId);

        // Èò≤ÊäñÂáΩÊï∞
        function debounce(fn, delay = 100) {
            let timer;
            return (...args) => {
                clearTimeout(timer);
                timer = setTimeout(() => fn.apply(this, args), delay);
            };
        }

        // Ê≠åÊõ≤ÂàáÊç¢
        function switchSong(newIndex) {
            if (newIndex < 0) newIndex = songList.length - 1;
            if (newIndex >= songList.length) newIndex = 0;
            
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }

            currentSongIndex = newIndex;
            const newSong = songList[newIndex];
            currentAudio = document.getElementById(newSong.audioId);
            if (currentAudio && currentAudio.readyState < 2) currentAudio.load();

            playerTitle.textContent = newSong.title;
            playerSinger.textContent = newSong.singer;
            totalTimeEl.textContent = newSong.defaultDuration;
            totalTimeEl.dataset.loaded = 'false';
            progress.style.width = '0%';
            currentTimeEl.textContent = '00:00';
            document.querySelectorAll('.player-cover').forEach(cover => cover.style.display = 'none');
            document.getElementById(newSong.coverId).style.display = 'block';

            if (playState.isPlaying && currentAudio) {
                currentAudio.play().then(() => {
                    playBtn.textContent = '‚è∏';
                    draggablePlayer.classList.add('playing');
                }).catch(() => alert('Êí≠ÊîæÂ§±Ë¥•ÔºåËØ∑ÁÇπÂáªÊí≠ÊîæÂô®ÈáçËØï'));
            } else {
                playBtn.textContent = '‚ñ∂';
                draggablePlayer.classList.remove('playing');
            }
            debouncedRenderPage(currentPage);
        }

        // ÂàÜÈ°µÊ∏≤ÊüìÔºà‰øÆÂ§çÈáçÂ§çÈóÆÈ¢òÔºâ
        function renderPage(page) {
            songListEl.innerHTML = '';
            const start = (page - 1) * PAGE_SIZE;
            const end = Math.min(start + PAGE_SIZE, songList.length);
            songList.slice(start, end).forEach((song, idx) => {
                const li = document.createElement('li');
                li.classList.toggle('active', start + idx === currentSongIndex);
                li.innerHTML = `${start + idx + 1}. ${song.title} - ${song.singer}`;
                li.addEventListener('click', () => switchSong(start + idx));
                songListEl.appendChild(li);
            });

            if (totalPages > 1) {
                // ÂÖàÂà†Èô§ÊóßÁöÑÂàÜÈ°µÊéß‰ª∂
                const oldPageControls = songListContainer.querySelector('.page-controls');
                if (oldPageControls) songListContainer.removeChild(oldPageControls);

                // ÂàõÂª∫Êñ∞ÂàÜÈ°µÊéß‰ª∂
                const pageControls = document.createElement('div');
                pageControls.className = 'page-controls';
                pageControls.innerHTML = `
                    <button class="page-btn" ${page === 1 ? 'disabled' : ''} onclick="currentPage--;debouncedRenderPage(currentPage)">‰∏ä‰∏ÄÈ°µ</button>
                    <span class="page-info">${page}/${totalPages}</span>
                    <button class="page-btn" ${page === totalPages ? 'disabled' : ''} onclick="currentPage++;debouncedRenderPage(currentPage)">‰∏ã‰∏ÄÈ°µ</button>
                `;
                songListContainer.appendChild(pageControls);
            }
        }
        const debouncedRenderPage = debounce(renderPage);

        // Êí≠Êîæ/ÊöÇÂÅú
        playBtn.addEventListener('click', () => {
            if (!currentAudio) return;
            if (currentAudio.paused) {
                currentAudio.play().then(() => {
                    playBtn.textContent = '‚è∏';
                    playState.isPlaying = true;
                    draggablePlayer.classList.add('playing');
                }).catch(() => alert('Êí≠ÊîæÂ§±Ë¥•ÔºåËØ∑ÁÇπÂáªÊí≠ÊîæÂô®ÈáçËØï'));
            } else {
                currentAudio.pause();
                playBtn.textContent = '‚ñ∂';
                playState.isPlaying = false;
                draggablePlayer.classList.remove('playing');
            }
        });

        // ‰∏ä/‰∏ã‰∏ÄÈ¶ñ
        prevBtn.addEventListener('click', () => switchSong(currentSongIndex - 1));
        nextBtn.addEventListener('click', () => switchSong(currentSongIndex + 1));

        // ÂàóË°®ÊòæÁ§∫/ÈöêËóè
        listToggleBtn.addEventListener('click', () => {
            songListContainer.classList.toggle('show');
            if (songListContainer.classList.contains('show')) {
                songListEl.innerHTML = '';
                debouncedRenderPage(currentPage);
            }
        });

        // Èü≥ÈáèÊéßÂà∂
        volumeBtn.addEventListener('click', () => {
            if (!currentAudio) return;
            currentAudio.volume = currentAudio.volume > 0.5 ? 0.3 : currentAudio.volume > 0 ? 0 : 0.7;
            volumeBtn.textContent = currentAudio.volume > 0.5 ? 'üîä' : currentAudio.volume > 0 ? 'üîâ' : 'üîá';
        });

        // ËøõÂ∫¶Êù°Êõ¥Êñ∞
        function updateProgress() {
            if (!currentAudio || isNaN(currentAudio.duration)) return;
            const percent = (currentAudio.currentTime / currentAudio.duration) * 100;
            progress.style.width = `${percent}%`;
            currentTimeEl.textContent = `${Math.floor(currentAudio.currentTime/60).toString().padStart(2, '0')}:${Math.floor(currentAudio.currentTime%60).toString().padStart(2, '0')}`;
            if (!totalTimeEl.dataset.loaded) {
                totalTimeEl.textContent = `${Math.floor(currentAudio.duration/60).toString().padStart(2, '0')}:${Math.floor(currentAudio.duration%60).toString().padStart(2, '0')}`;
                totalTimeEl.dataset.loaded = 'true';
            }
        }
        setInterval(updateProgress, 1000);

        // ËøõÂ∫¶Êù°ÁÇπÂáª
        document.getElementById('miniProgressBar').addEventListener('click', (e) => {
            if (!currentAudio || isNaN(currentAudio.duration)) return;
            const rect = e.target.getBoundingClientRect();
            const percent = (e.clientX - rect.left) / rect.width;
            currentAudio.currentTime = percent * currentAudio.duration;
        });

        // ÊãñÂä®ÂäüËÉΩ
        draggablePlayer.addEventListener('mousedown', (e) => {
            if (e.target.closest('.player-btn, .volume-btn, .toggle-btn')) return;
            isDragging = true;
            const rect = playerContainer.getBoundingClientRect();
            const offsetX = e.clientX - rect.left;
            document.addEventListener('mousemove', moveHandler);
            document.addEventListener('mouseup', () => {
                isDragging = false;
                document.removeEventListener('mousemove', moveHandler);
            });
            function moveHandler(e) {
                if (!isDragging) return;
                const newLeft = e.clientX - offsetX;
                const maxLeft = window.innerWidth - playerContainer.offsetWidth;
                playerContainer.style.left = `${Math.max(0, Math.min(newLeft, maxLeft))}px`;
            }
        });

        // ÂàùÂßãÂåñ
        window.addEventListener('load', () => {
            debouncedRenderPage(currentPage);
            songListContainer.classList.remove('show');
        });
    </script>
</body>
</html>
