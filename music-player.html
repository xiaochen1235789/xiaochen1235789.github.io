<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëø∑‰Ω†Èü≥‰πêÊí≠ÊîæÂô®</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: transparent; 
            padding: 0; 
            margin: 0; 
            height: 100vh;
            overflow: hidden;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        /* Ëø∑‰Ω†Êí≠ÊîæÂô®ÂÆπÂô® */
        .mini-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 99999;
            width: 280px;
            height: 70px;
            background: rgba(30, 58, 47, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 35px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            border: 1px solid rgba(61, 114, 95, 0.5);
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 12px;
            cursor: move;
            transition: all 0.3s ease;
            user-select: none;
        }
        
        .mini-player:hover {
            background: rgba(30, 58, 47, 0.98);
            box-shadow: 0 6px 25px rgba(0,0,0,0.4);
            transform: translateY(-2px);
        }
        
        /* Ëø∑‰Ω†Â∞ÅÈù¢ */
        .mini-cover {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }
        
        .mini-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .playing .mini-cover img {
            animation: rotateCover 20s linear infinite;
        }
        
        @keyframes rotateCover {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Ê≠åÊõ≤‰ø°ÊÅØ */
        .mini-info {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .mini-title {
            font-size: 0.9rem;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
        }
        
        .mini-singer {
            font-size: 0.75rem;
            color: #99aabb;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ÊéßÂà∂ÊåâÈíÆ */
        .mini-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }
        
        .mini-btn {
            background: transparent;
            border: none;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 1rem;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .mini-btn:hover {
            background: rgba(129, 199, 132, 0.15);
            color: #81c784;
            transform: scale(1.1);
        }
        
        .play-btn {
            background: #81c784;
            color: #121212;
            font-size: 1.1rem;
        }
        
        .play-btn:hover {
            background: #a8d0b9;
            color: #121212;
        }
        
        /* Èü≥ÈáèÊéßÂà∂ */
        .volume-popup {
            position: absolute;
            bottom: 80px;
            right: 0;
            background: rgba(30, 58, 47, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            display: none;
            z-index: 100000;
        }
        
        .volume-popup.show {
            display: block;
        }
        
        .volume-slider {
            width: 120px;
            height: 4px;
            -webkit-appearance: none;
            background: rgba(45, 82, 67, 0.8);
            border-radius: 2px;
            outline: none;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #81c784;
            cursor: pointer;
        }
        
        /* ËøõÂ∫¶Êù° */
        .progress-overlay {
            position: absolute;
            top: -6px;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(45, 82, 67, 0.5);
            border-radius: 1.5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: #81c784;
            transition: width 0.3s ease;
        }
        
        /* Êó∂Èó¥ÊòæÁ§∫ */
        .time-tooltip {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 58, 47, 0.95);
            color: #99aabb;
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
            display: none;
            z-index: 100000;
        }
        
        /* ÈöêËóèÈü≥È¢ë */
        audio { display: none; }
    </style>
</head>
<body>
    <!-- Ëø∑‰Ω†Êí≠ÊîæÂô® -->
    <div class="mini-player" id="miniPlayer">
        <div class="progress-overlay">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="mini-cover" id="miniCover">
            <img src="" alt="Â∞ÅÈù¢" id="coverImage">
        </div>
        
        <div class="mini-info">
            <div class="mini-title" id="songTitle">Âä†ËΩΩ‰∏≠...</div>
            <div class="mini-singer" id="songSinger"></div>
        </div>
        
        <div class="mini-controls">
            <button class="mini-btn" id="prevBtn" title="‰∏ä‰∏ÄÈ¶ñ">‚èÆ</button>
            <button class="mini-btn play-btn" id="playBtn" title="Êí≠Êîæ/ÊöÇÂÅú">‚ñ∂</button>
            <button class="mini-btn" id="nextBtn" title="‰∏ã‰∏ÄÈ¶ñ">‚è≠</button>
            <button class="mini-btn" id="volumeBtn" title="Èü≥Èáè">üîä</button>
        </div>
        
        <!-- Èü≥ÈáèÊéßÂà∂ÂºπÂá∫Â±Ç -->
        <div class="volume-popup" id="volumePopup">
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.01" value="0.7">
        </div>
        
        <!-- Êó∂Èó¥ÊèêÁ§∫ -->
        <div class="time-tooltip" id="timeTooltip">00:00 / 00:00</div>
    </div>

    <audio id="audioPlayer" preload="metadata"></audio>

<script>
    // üéµ ========== Ê≠åÊõ≤ÂàóË°® ========== üéµ
    // Âè™ÈúÄ‰øÆÊîπËøô‰∏™Êï∞ÁªÑÊù•Ê∑ªÂä†/Âà†Èô§Ê≠åÊõ≤
    const songList = [
        {
            title: 'ÊòîÊ∂ü',
            singer: 'Âº†Èü∂Ê∂µ„ÄÅHOYO-MiX',
            audioUrl: 'http://music.163.com/song/media/outer/url?id=3316968660.mp3',
            duration: '03:06',
            coverUrl: 'http://p2.music.126.net/BKJrPO1FlbXcy-98AYXOzg==/109951172268004943.jpg?param=300x300'
        },
        {
            title: 'ËÄÄÊñë',
            singer: 'HOYO-MiX,YMIR',
            audioUrl: 'http://music.163.com/song/media/outer/url?id=2722510685.mp3',
            duration: '03:33',
            coverUrl: 'http://p2.music.126.net/DYDACa_8zB5irAOrasVgnQ==/109951171396677694.jpg?param=300x300'
        },
        {
            title: 'ÊãÇÊôì Proi Proi',
            singer: 'HOYO-MiX,NIDA',
            audioUrl: 'http://music.163.com/song/media/outer/url?id=2709812973.mp3',
            duration: '03:58',
            coverUrl: 'http://p2.music.126.net/2qGGwWFlMYF2o-GyNMhH5A==/109951171066942237.jpg?param=300x300'
        }
    ];

    // Êí≠ÊîæÁä∂ÊÄÅ
    let currentSongIndex = 0;
    let isPlaying = false;
    let volume = 0.7;
    let isDragging = false;
    let dragOffsetX = 0;
    let dragOffsetY = 0;

    // DOMÂÖÉÁ¥†
    const miniPlayer = document.getElementById('miniPlayer');
    const audioPlayer = document.getElementById('audioPlayer');
    const playBtn = document.getElementById('playBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const volumeBtn = document.getElementById('volumeBtn');
    const volumePopup = document.getElementById('volumePopup');
    const volumeSlider = document.getElementById('volumeSlider');
    const songTitle = document.getElementById('songTitle');
    const songSinger = document.getElementById('songSinger');
    const coverImage = document.getElementById('coverImage');
    const progressFill = document.getElementById('progressFill');
    const timeTooltip = document.getElementById('timeTooltip');

    // Ê†ºÂºèÂåñÊó∂Èó¥
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
        const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
        return `${mins}:${secs}`;
    }

    // Êõ¥Êñ∞Êí≠ÊîæÂô®UI
    function updatePlayerUI() {
        const song = songList[currentSongIndex];
        
        songTitle.textContent = song.title;
        songSinger.textContent = song.singer;
        coverImage.src = song.coverUrl;
        coverImage.alt = song.title;
        
        playBtn.textContent = isPlaying ? '‚è∏' : '‚ñ∂';
        
        // ÊéßÂà∂ÊåâÈíÆÊòæÁ§∫
        prevBtn.style.display = songList.length > 1 ? 'flex' : 'none';
        nextBtn.style.display = songList.length > 1 ? 'flex' : 'none';
        
        // Â∞ÅÈù¢ÊóãËΩ¨
        if (isPlaying) {
            miniPlayer.classList.add('playing');
        } else {
            miniPlayer.classList.remove('playing');
        }
    }

    // Âä†ËΩΩÊ≠åÊõ≤
    function loadSong(index) {
        if (index < 0 || index >= songList.length) return;
        
        currentSongIndex = index;
        const song = songList[index];
        
        audioPlayer.src = song.audioUrl;
        audioPlayer.load();
        
        if (isPlaying) {
            audioPlayer.play().catch(e => {
                console.log('Ëá™Âä®Êí≠ÊîæÂ§±Ë¥•ÔºåÁ≠âÂæÖÁî®Êà∑‰∫§‰∫í');
                isPlaying = false;
            });
        }
        
        updatePlayerUI();
        updateProgress();
    }

    // ÂàáÊç¢Êí≠ÊîæÁä∂ÊÄÅ
    function togglePlay() {
        isPlaying = !isPlaying;
        
        if (isPlaying) {
            // Â¶ÇÊûúËøòÊ≤°ËÆæÁΩÆÈü≥È¢ëÊ∫êÔºåÂÖàÂä†ËΩΩÂΩìÂâçÊ≠åÊõ≤
            if (!audioPlayer.src) {
                loadSong(currentSongIndex);
            }
            audioPlayer.play();
        } else {
            audioPlayer.pause();
        }
        
        updatePlayerUI();
    }

    // Êõ¥Êñ∞ËøõÂ∫¶Êù°
    function updateProgress() {
        if (!audioPlayer.duration) return;
        
        const percent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        progressFill.style.width = `${percent}%`;
        
        // ÊòæÁ§∫Êó∂Èó¥ÊèêÁ§∫
        if (isDragging) {
            timeTooltip.textContent = `${formatTime(audioPlayer.currentTime)} / ${formatTime(audioPlayer.duration)}`;
        }
    }

    // ËøõÂ∫¶Êù°ÁÇπÂáª
    miniPlayer.addEventListener('click', (e) => {
        const rect = miniPlayer.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const percent = clickX / rect.width;
        
        if (audioPlayer.duration) {
            audioPlayer.currentTime = percent * audioPlayer.duration;
            updateProgress();
        }
    });

    // ÊãñÂä®ËøõÂ∫¶Êù°
    miniPlayer.addEventListener('mousedown', (e) => {
        if (e.target.closest('.mini-btn, .volume-popup')) return;
        
        isDragging = true;
        const rect = miniPlayer.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        
        const moveHandler = (moveEvent) => {
            const moveX = moveEvent.clientX - rect.left;
            const percent = Math.max(0, Math.min(1, moveX / rect.width));
            
            if (audioPlayer.duration) {
                audioPlayer.currentTime = percent * audioPlayer.duration;
                updateProgress();
                
                // ÊòæÁ§∫Êó∂Èó¥ÊèêÁ§∫
                timeTooltip.style.display = 'block';
                timeTooltip.style.left = `${moveX}px`;
            }
        };
        
        const upHandler = () => {
            isDragging = false;
            timeTooltip.style.display = 'none';
            document.removeEventListener('mousemove', moveHandler);
            document.removeEventListener('mouseup', upHandler);
        };
        
        document.addEventListener('mousemove', moveHandler);
        document.addEventListener('mouseup', upHandler);
        
        // ÂàùÂßãÁÇπÂáª
        if (audioPlayer.duration) {
            audioPlayer.currentTime = Math.max(0, Math.min(1, clickX / rect.width)) * audioPlayer.duration;
            updateProgress();
        }
        
        e.preventDefault();
    });

    // Êí≠ÊîæÂô®ÊãñÂä®ÂäüËÉΩ
    miniPlayer.addEventListener('mousedown', (e) => {
        if (e.target.closest('.mini-btn') || e.target.closest('.volume-popup')) return;
        
        const startX = e.clientX;
        const startY = e.clientY;
        const startLeft = parseInt(window.getComputedStyle(miniPlayer).left) || 0;
        const startTop = parseInt(window.getComputedStyle(miniPlayer).top) || 0;
        
        const moveHandler = (moveEvent) => {
            const deltaX = moveEvent.clientX - startX;
            const deltaY = moveEvent.clientY - startY;
            
            let newLeft = startLeft + deltaX;
            let newTop = startTop + deltaY;
            
            // ÈôêÂà∂Âú®Á™óÂè£ÂÜÖ
            newLeft = Math.max(10, Math.min(newLeft, window.innerWidth - miniPlayer.offsetWidth - 10));
            newTop = Math.max(10, Math.min(newTop, window.innerHeight - miniPlayer.offsetHeight - 10));
            
            miniPlayer.style.left = `${newLeft}px`;
            miniPlayer.style.top = `${newTop}px`;
            miniPlayer.style.right = 'auto';
            miniPlayer.style.bottom = 'auto';
            miniPlayer.style.transform = 'none';
        };
        
        const upHandler = () => {
            document.removeEventListener('mousemove', moveHandler);
            document.removeEventListener('mouseup', upHandler);
        };
        
        document.addEventListener('mousemove', moveHandler);
        document.addEventListener('mouseup', upHandler);
    });

    // ‰∫ã‰ª∂ÁõëÂê¨
    playBtn.addEventListener('click', togglePlay);
    
    prevBtn.addEventListener('click', () => {
        if (songList.length <= 1) return;
        currentSongIndex = (currentSongIndex - 1 + songList.length) % songList.length;
        loadSong(currentSongIndex);
        if (isPlaying) audioPlayer.play();
    });
    
    nextBtn.addEventListener('click', () => {
        if (songList.length <= 1) return;
        currentSongIndex = (currentSongIndex + 1) % songList.length;
        loadSong(currentSongIndex);
        if (isPlaying) audioPlayer.play();
    });

    // Èü≥ÈáèÊéßÂà∂
    volumeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        volumePopup.classList.toggle('show');
    });

    volumeSlider.addEventListener('input', (e) => {
        volume = parseFloat(e.target.value);
        audioPlayer.volume = volume;
        
        // Êõ¥Êñ∞Èü≥ÈáèÂõæÊ†á
        if (volume === 0) {
            volumeBtn.textContent = 'üîá';
        } else if (volume < 0.5) {
            volumeBtn.textContent = 'üîâ';
        } else {
            volumeBtn.textContent = 'üîä';
        }
    });

    // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠Èü≥ÈáèÊéßÂà∂
    document.addEventListener('click', (e) => {
        if (!volumePopup.contains(e.target) && e.target !== volumeBtn) {
            volumePopup.classList.remove('show');
        }
    });

    // Èü≥È¢ë‰∫ã‰ª∂
    audioPlayer.addEventListener('timeupdate', updateProgress);
    
    audioPlayer.addEventListener('ended', () => {
        if (songList.length > 1) {
            currentSongIndex = (currentSongIndex + 1) % songList.length;
            loadSong(currentSongIndex);
            if (isPlaying) audioPlayer.play();
        } else {
            audioPlayer.currentTime = 0;
            isPlaying = false;
            updatePlayerUI();
        }
    });

    audioPlayer.addEventListener('loadedmetadata', () => {
        updateProgress();
    });

    // ÂàùÂßãÂåñ
    window.addEventListener('load', () => {
        // Âä†ËΩΩÁ¨¨‰∏ÄÈ¶ñÊ≠å
        loadSong(0);
        
        // ËÆæÁΩÆÈü≥Èáè
        audioPlayer.volume = volume;
        volumeSlider.value = volume;
        
        // Âè≥ÈîÆËèúÂçïÊéßÂà∂
        miniPlayer.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            alert(`ÂΩìÂâçÊí≠Êîæ: ${songList[currentSongIndex].title}\nÂàóË°®: ${songList.map(s => s.title).join(', ')}`);
        });
        
        // ÂèåÂáªÂàáÊç¢Êí≠ÊîæÁä∂ÊÄÅ
        miniPlayer.addEventListener('dblclick', (e) => {
            if (e.target.closest('.mini-btn')) return;
            togglePlay();
        });
    });

    // ÈîÆÁõòÂø´Êç∑ÈîÆ
    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space' && !e.target.matches('input, textarea')) {
            e.preventDefault();
            togglePlay();
        }
        
        if (e.code === 'ArrowLeft' && songList.length > 1) {
            e.preventDefault();
            prevBtn.click();
        }
        
        if (e.code === 'ArrowRight' && songList.length > 1) {
            e.preventDefault();
            nextBtn.click();
        }
    });
</script>
</body>
</html>