<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="å¿«ä¹çš„è·¯ä¸€å¤© - å…‰é”¥è¯¦æƒ…ã€‚å·¡çŒè·¯å¾„ï¼Œé¹¿å°†å†›ä¸“æ­¦ã€‚">
    <link rel="icon" href="https://xiaochen1235789.github.io/images/wangzhantupian.png" type="image/png">
    <title>å¿«ä¹çš„è·¯ä¸€å¤© - å…­å“¥è£è€€WIKI</title>
    <style>
        :root {
            --bg: #121212;
            --card-bg: #1e3a2f;
            --card-bg-hover: #284a3c;
            --text-main: #e0e0e0;
            --text-highlight: #81c784;
            --text-secondary: #99aabb;
            --radius: 6px;
            --gap: 12px;
            --special-color: #ffd700;
            --border-color: #3d725f;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft YaHei", "PingFang SC", sans-serif; }
        body {
            background: var(--bg);
            color: var(--text-main);
            line-height: 1.5;
            min-height: 100vh;
            padding-bottom: 120px;
        }
        /* åŠ è½½è¿›åº¦æ¡ä¸åŠ¨ç”» (ä¸ä¸»é¡µä¸€è‡´) */
        .loading-progress {
            position: fixed; top: 0; left: 0; width: 0%; height: 3px;
            background: var(--text-highlight); z-index: 9999999;
            transition: width 0.3s ease, opacity 0.5s ease; opacity: 1;
        }
        #global-loading {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: var(--bg); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 999999;
            transition: opacity 0.5s ease;
        }
        .loading-spinner {
            display: inline-block; width: 50px; height: 50px;
            border: 4px solid rgba(129, 199, 132, 0.3); border-radius: 50%;
            border-top-color: var(--text-highlight); animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .skeleton {
            background: linear-gradient(90deg, #2a3a35 25%, #354540 50%, #2a3a35 75%);
            background-size: 200% 100%; animation: skeleton-loading 1.5s infinite;
            border-radius: var(--radius);
        }
        @keyframes skeleton-loading {
            0% { background-position: 200% 0; } 100% { background-position: -200% 0; }
        }

        /* é¡¶éƒ¨è¿”å›å¯¼èˆª (é£æ ¼ä¸ä¸»é¡µå¯¼èˆªç»Ÿä¸€) */
        .top-nav {
            background: var(--card-bg); border-radius: var(--radius);
            padding: 12px 20px; margin: 16px auto;
            display: flex; align-items: center; max-width: 800px;
            box-shadow: var(--shadow); border: 1px solid transparent;
            transition: border-color var(--transition-normal);
        }
        .top-nav:hover { border-color: var(--border-color); }
        .back-btn {
            color: var(--text-highlight); text-decoration: none; font-size: 1.1rem;
            display: flex; align-items: center; gap: 8px; transition: all var(--transition-fast);
            font-weight: 500;
        }
        .back-btn:hover { color: var(--special-color); transform: translateX(-2px); }
        .page-title { margin-left: auto; font-size: 1.2rem; color: var(--text-highlight); font-weight: 600; }

        /* ä¸»å†…å®¹å®¹å™¨ */
        .detail-container {
            max-width: 800px; margin: 0 auto; padding: 0 16px;
            display: flex; flex-direction: column; gap: var(--gap);
        }
        /* å…‰é”¥æ ¸å¿ƒå¡ç‰‡ (ç»§æ‰¿ä¸»é¡µå¡ç‰‡äº¤äº’) */
        .lightcone-hero-card {
            background: var(--card-bg); border-radius: var(--radius); padding: 24px;
            text-align: center; border: 1px solid transparent;
            transition: all var(--transition-normal); box-shadow: var(--shadow);
            display: flex; flex-direction: column; align-items: center;
        }
        .lightcone-hero-card:hover {
            transform: translateY(-4px); border-color: var(--text-highlight);
            background: var(--card-bg-hover); box-shadow: 0 8px 24px rgba(0,0,0,0.4);
        }
        .lightcone-img-container {
            width: 70%; max-width: 280px; margin-bottom: 20px;
            border-radius: var(--radius); overflow: hidden; position: relative;
            aspect-ratio: 3/4; border: 1px solid var(--border-color);
        }
        .lightcone-img-container.skeleton { background: #2d5243; }
        .lightcone-img {
            width: 100%; height: 100%; object-fit: cover; display: block;
            transition: transform var(--transition-normal); opacity: 0;
        }
        .lightcone-img.loaded { opacity: 1; }
        .lightcone-hero-card:hover .lightcone-img { transform: scale(1.05); }
        .lightcone-name {
            font-size: 1.8rem; color: var(--text-highlight); margin-bottom: 8px;
            font-weight: 700; text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .lightcone-path { color: var(--text-secondary); margin-bottom: 20px; font-size: 1rem; }
        .lightcone-stats {
            display: flex; justify-content: center; gap: 24px; flex-wrap: wrap;
            margin-top: 16px; width: 100%;
        }
        .stat-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
        }
        .stat-emoji { font-size: 1.5rem; }
        .stat-label { font-size: 0.9rem; color: var(--text-secondary); }
        .stat-value { font-size: 1.1rem; color: var(--text-highlight); font-weight: 600; }

        /* æ•ˆæœä¸æ•…äº‹æ¨¡å— (æ ·å¼ä¸ä¸»é¡µæ›´æ–°æ—¥å¿—ç­‰æ¨¡å—åè°ƒ) */
        .detail-module {
            background: var(--card-bg); border-radius: var(--radius); padding: 24px;
            border: 1px solid var(--border-color); box-shadow: var(--shadow);
        }
        .module-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 16px; padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        .module-title {
            font-size: 1.4rem; color: var(--text-highlight); font-weight: 600;
            display: flex; align-items: center; gap: 8px;
        }
        .module-title::before { content: "âœ¨"; }
        .version-select {
            background: var(--card-bg-hover); color: var(--text-main);
            border: 1px solid var(--border-color); padding: 6px 12px;
            border-radius: var(--radius); cursor: pointer; font-size: 0.9rem;
            transition: all var(--transition-fast); outline: none;
        }
        .version-select:hover, .version-select:focus {
            border-color: var(--text-highlight); background: #2d5243;
        }
        .module-content {
            line-height: 1.7; color: var(--text-main); font-size: 0.95rem;
        }
        .module-content .highlight {
            color: var(--special-color); font-weight: 700; background: rgba(255,215,0,0.08);
            padding: 0 2px; border-radius: 2px;
        }
        .version-log {
            margin-top: 16px; padding: 10px 14px; background: rgba(129, 199, 132, 0.05);
            border-radius: var(--radius); font-size: 0.85rem; color: var(--text-highlight);
            border-left: 3px solid var(--text-highlight);
        }
        .lore-content {
            white-space: pre-line; line-height: 1.8;
        }
        .lore-content::first-letter {
            font-size: 1.5em; color: var(--special-color); font-weight: bold;
            float: left; line-height: 1; margin-right: 4px;
        }

        /* å›åˆ°é¡¶éƒ¨æŒ‰é’® (ä¸ä¸»é¡µä¸€è‡´) */
        .back-to-top {
            position: fixed; bottom: 140px; right: 20px; width: 46px; height: 46px;
            background: var(--card-bg-hover); color: var(--text-highlight);
            border-radius: 50%; display: flex; align-items: center;
            justify-content: center; font-size: 1.2rem; cursor: pointer;
            box-shadow: var(--shadow); opacity: 0; visibility: hidden;
            transition: all var(--transition-normal); z-index: 9999;
            border: 1px solid var(--text-highlight);
        }
        .back-to-top.show { opacity: 1; visibility: visible; }
        .back-to-top:hover { background: var(--text-highlight); color: var(--bg); transform: translateY(-2px); }

        /* é€šçŸ¥æ¶ˆæ¯ (ä¸ä¸»é¡µä¸€è‡´) */
        .notification {
            position: fixed; top: 20px; right: 20px; background: var(--card-bg);
            color: var(--text-highlight); padding: 12px 20px; border-radius: var(--radius);
            box-shadow: var(--shadow); z-index: 10000; transform: translateX(120%);
            transition: transform 0.4s ease; border-left: 4px solid var(--text-highlight);
            max-width: 300px;
        }
        .notification.show { transform: translateX(0); }
        .notification.success { border-left-color: #4ade80; color: #4ade80; }

        /* å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 768px) {
            .detail-container { padding: 0 12px; }
            .lightcone-img-container { width: 85%; }
            .lightcone-name { font-size: 1.5rem; }
            .module-header { flex-direction: column; align-items: flex-start; gap: 10px; }
            .version-select { align-self: flex-start; }
            .back-to-top { bottom: 120px; right: 15px; width: 42px; height: 42px; }
            body { padding-bottom: 100px; }
        }
        @media (max-width: 480px) {
            .lightcone-stats { gap: 16px; }
            .stat-item { min-width: 80px; }
            .top-nav { padding: 10px 16px; margin: 12px auto; }
            .detail-module { padding: 18px; }
        }

        /* éŸ³ä¹æ’­æ”¾å™¨ (æ ·å¼ä¸ä¸»é¡µå®Œå…¨åŒæ­¥) */
        #musicPlayerIframe {
            display: block !important; visibility: visible !important;
            height: 400px !important; width: 100% !important;
            z-index: 99999 !important; position: fixed !important;
            bottom: 0 !important; left: 0 !important; right: 0 !important;
            border: none !important; background: transparent !important;
            overflow: visible !important; transition: height 0.3s ease !important;
            will-change: height;
        }
    </style>
</head>
<body>
    <!-- åŠ è½½è¿›åº¦æ¡ -->
    <div class="loading-progress" id="loadingProgress"></div>
    <!-- å…¨å±€åŠ è½½åŠ¨ç”» -->
    <div id="global-loading">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <p style="color: var(--text-highlight); margin-top: 16px; font-size: 1.1rem;">åŠ è½½èµ„æºä¸­...</p>
        </div>
    </div>
    <!-- é€šçŸ¥æ¶ˆæ¯ -->
    <div class="notification" id="notification"></div>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="top-nav" aria-label="é¡µé¢å¯¼èˆª">
        <a href="./index.html" class="back-btn" id="backBtn">
            â€¹ <span>è¿”å›ä¸»é¡µ</span>
        </a>
        <div class="page-title">å…‰é”¥è¯¦æƒ…</div>
    </nav>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="detail-container">
        <!-- å…‰é”¥æ ¸å¿ƒä¿¡æ¯å¡ç‰‡ -->
        <section class="lightcone-hero-card" aria-labelledby="lcName">
            <div class="lightcone-img-container skeleton">
                <img src="https://xiaochen1235789.github.io/guangzhui.images/changjinglu.jpg"
                     alt="å…‰é”¥ã€Œå¿«ä¹çš„è·¯ä¸€å¤©ã€ç«‹ç»˜"
                     class="lightcone-img"
                     loading="eager"
                     onload="imageLoaded(this)"
                     onerror="imageError(this)">
            </div>
            <h1 id="lcName" class="lightcone-name">å¿«ä¹çš„è·¯ä¸€å¤©</h1>
            <p class="lightcone-path">å·¡çŒ | é¹¿å°†å†›ä¸“æ­¦</p>
            <div class="lightcone-stats">
                <div class="stat-item"><span class="stat-emoji">â¤ï¸</span><span class="stat-label">ç”Ÿå‘½å€¼</span><span class="stat-value">1058</span></div>
                <div class="stat-item"><span class="stat-emoji">âš”ï¸</span><span class="stat-label">æ”»å‡»åŠ›</span><span class="stat-value">582</span></div>
                <div class="stat-item"><span class="stat-emoji">ğŸ›¡ï¸</span><span class="stat-label">é˜²å¾¡åŠ›</span><span class="stat-value">463</span></div>
            </div>
        </section>

        <!-- å…‰é”¥æ•ˆæœæ¨¡å— -->
        <section class="detail-module" aria-labelledby="effectTitle">
            <div class="module-header">
                <h2 id="effectTitle" class="module-title">å…‰é”¥æ•ˆæœï¼šè¶Šè›‡è¶Šå¤š</h2>
                <select class="version-select" id="versionSelect" aria-label="é€‰æ‹©æŠ€èƒ½æè¿°ç‰ˆæœ¬">
                    <option value="v1">V1 ç‰ˆæœ¬</option>
                    <option value="v2" selected>V2 æ­£å¼ç‰ˆ</option>
                </select>
            </div>
            <div class="module-content" id="skillDesc">
                <!-- å†…å®¹ç”±JSåŠ¨æ€å¡«å…… -->
            </div>
            <div class="version-log" id="versionLog"><!-- æ›´æ–°æ—¥å¿—ç”±JSåŠ¨æ€å¡«å…… --></div>
        </section>

        <!-- å…‰é”¥èƒŒæ™¯æ•…äº‹æ¨¡å— -->
        <section class="detail-module" aria-labelledby="loreTitle">
            <div class="module-header">
                <h2 id="loreTitle" class="module-title">å…‰é”¥æ•…äº‹</h2>
            </div>
            <div class="module-content lore-content">
                é£å±¿çš„æ²™ä¸˜æ›¾åŸ‹ç€é€é£éƒ¨è½çš„æ¬¢å£°ç¬‘è¯­ï¼Œç›´åˆ°çŸ¿é˜Ÿä¸é­”ç‰©è¸ç¢ç»¿æ´²çš„å®é™ã€‚å¹´è½»çŒæ‰‹é¹¿ç®¡å½’æ¥æ—¶ï¼Œåªå‰©è…°é—´çš®å›Šé‡Œçš„æ•…ä¹¡æ³¥åœŸï¼Œå’Œå…ˆè¾ˆé—ç•™çš„é£åˆƒã€‚
                <br>
                ä»–å¾ªç€é£æ²™è¿½çŒä»‡æ•Œï¼Œé£ä¸ºä»–å¼•è·¯ï¼Œé€Ÿåº¦æˆäº†æœ€é”‹åˆ©çš„æ­¦å™¨ã€‚æ¯å¤šä¸€åˆ†è¿…æ·ï¼Œä¾¿å¤šä¸€åˆ†ç ´æ•Œçš„åº•æ°”ã€‚
                <br>
                å²æœˆæµè½¬ï¼Œé¹¿ç®¡å¸¦é¢†å¹¸å­˜è€…è‚ƒæ¸…é­”ç‰©ï¼Œæˆä¸ºç»Ÿé¢†ã€Œé£å±¿é—æ°‘ã€çš„å°†å†›ã€‚ä½†ä»–ä»åçˆ±ç‹¬è‡ªå·¡çŒï¼Œé•œå­ä¸­æ˜ ç€ä»–çš„èº«å½±ï¼Œæ—¢æ˜¯å¤ä»‡çš„æ‰§å¿µï¼Œä¹Ÿæ˜¯å®ˆæŠ¤çš„èª“è¨€ã€‚
                <br>
                æœ‰äººé—®ä»–ä¸ºä½•æ‰§ç€ï¼Œä»–ä¼šæ’’ä¸‹ä¸€æŠŠæ•…ä¹¡çš„æ³¥åœŸï¼šã€Œæ‰€è°“å¿«ä¹çš„è·¯ï¼Œæ˜¯ç”¨é£åˆƒä¸ºæ—äººåŠˆå¼€å½’é€”ï¼Œä¸ºè’èŠœæ’­ç§å¸Œæœ›ã€‚ã€è¿™å¥è¯ä¾¿æˆäº†ä»–å·¡çŒæ˜Ÿç©¹çš„è§è¯ï¼Œè®°å½•ç€ä¸€ä½å°†å†›ä¸é£åŒè¡Œçš„åšå®ˆã€‚
                <br>
            </div>
        </section>
    </main>

    <!-- éŸ³ä¹æ’­æ”¾å™¨ -->
    <iframe 
        id="musicPlayerIframe"
        src="music-player.html"
        frameborder="0"
        scrolling="no"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy"
        title="éŸ³ä¹æ’­æ”¾å™¨"
        aria-label="éŸ³ä¹æ’­æ”¾å™¨"
    ></iframe>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" onclick="scrollToTop()" aria-label="å›åˆ°é¡¶éƒ¨">â†‘</button>

    <script>
        // ä»ä¸»é¡µé›†æˆçš„æ ¸å¿ƒå·¥å…·å‡½æ•°
        function imageLoaded(img) {
            img.classList.add('loaded');
            const parent = img.closest('.skeleton');
            if (parent) parent.classList.remove('skeleton');
        }
        function imageError(img) {
            console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', img.src);
            img.src = `https://via.placeholder.com/280x373/2d5243/81c784?text=å›¾ç‰‡åŠ è½½å¤±è´¥`;
            img.alt = 'å›¾ç‰‡åŠ è½½å¤±è´¥';
            const parent = img.closest('.skeleton');
            if (parent) parent.classList.remove('skeleton');
        }
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // é¡µé¢æ ¸å¿ƒé€»è¾‘
        document.addEventListener('DOMContentLoaded', () => {
            const loadStartTime = Date.now();
            updateLoadingProgress(30);

            // 1. åˆå§‹åŒ–ç‰ˆæœ¬åˆ‡æ¢åŠŸèƒ½
            const versionData = {
                v1: {
                    desc: `ä½¿è£…å¤‡è€…çš„æš´å‡»ç‡æé«˜ <span class="highlight">20%/22%/24%/26%/28%</span>ï¼Œæš´å‡»ä¼¤å®³æé«˜<span class="highlight">36%/45%/54%/63%/72%</span>ï¼Œé€Ÿåº¦æé«˜<span class="highlight">18%/21%/24%/27%/30%</span>ï¼Œå¯¹ç”Ÿå‘½å€¼â‰¤90%çš„æ•Œæ–¹ç›®æ ‡å•ä½“é¢å¤–é€ æˆç­‰åŒäºè£…å¤‡è€…<span class="highlight">60%/80%/100%/120%/140%</span>æ”»å‡»åŠ›çš„é£å±æ€§çš„é™„åŠ ä¼¤å®³ã€‚`,
                    log: "V1 åˆå§‹ç‰ˆæœ¬ï¼šåˆç‰ˆä¸åšè¯„ä»·"
                },
                v2: {
                    desc: `ä½¿è£…å¤‡è€…çš„æš´å‡»ç‡æé«˜<span class="highlight">20%/22.5%/25.0%/27.5%/30.0%</span>ï¼Œå½“è£…å¤‡è€…åœ¨æˆ˜æ–—ä¸­é€Ÿåº¦å¤§äº100æ—¶ï¼Œæ¯è¶…è¿‡6ç‚¹ï¼Œå¼€å±€ç«‹å³è·å¾—1å±‚[æš—æ¶Œ]ï¼Œæ¯å±‚[æš—æ¶Œ]ä½¿è£…å¤‡è€…æ™®æ”»å’Œæˆ˜æŠ€é€ æˆçš„ä¼¤å®³æé«˜<span class="highlight">6%/8%/10%/12%/14%</span>ï¼Œç»ˆç»“æŠ€çš„æš´å‡»ä¼¤å®³æé«˜<span class="highlight">16%/18%/20%/22%/24%</span>ï¼Œè¯¥æ•ˆæœå¯å åŠ 10å±‚ã€‚`,
                    log: "V2 æ­£å¼ç‰ˆï¼šå½“å‰ç”Ÿæ•ˆç‰ˆæœ¬"
                }
            };
            const versionSelect = document.getElementById('versionSelect');
            const skillDescEl = document.getElementById('skillDesc');
            const versionLogEl = document.getElementById('versionLog');
            function updateVersionDisplay() {
                const ver = versionSelect.value;
                skillDescEl.innerHTML = versionData[ver].desc;
                versionLogEl.textContent = versionData[ver].log;
            }
            versionSelect.addEventListener('change', updateVersionDisplay);
            updateVersionDisplay(); // åˆå§‹åŒ–æ˜¾ç¤º

            updateLoadingProgress(60);

            // 2. åˆå§‹åŒ–æ»šåŠ¨ç›¸å…³åŠŸèƒ½
            const backToTopBtn = document.querySelector('.back-to-top');
            window.addEventListener('scroll', () => {
                backToTopBtn.classList.toggle('show', window.scrollY > 300);
            });

            updateLoadingProgress(80);

            // 3. é¡µé¢åŠ è½½å®Œæˆ
            setTimeout(() => {
                updateLoadingProgress(100);
                const loadTime = Date.now() - loadStartTime;
                console.log(`è¯¦æƒ…é¡µåŠ è½½å®Œæˆï¼Œè€—æ—¶ ${loadTime}ms`);
                // éšè—åŠ è½½åŠ¨ç”»
                const loadingEl = document.getElementById('global-loading');
                const progressBar = document.getElementById('loadingProgress');
                if (loadingEl) {
                    loadingEl.style.opacity = '0';
                    setTimeout(() => { loadingEl.style.display = 'none'; }, 500);
                }
                if (progressBar) {
                    progressBar.style.opacity = '0';
                    setTimeout(() => { progressBar.style.display = 'none'; }, 500);
                }
                showNotification('å…‰é”¥è¯¦æƒ…åŠ è½½å®Œæˆï¼', 'success');
            }, 400);
        });

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°åŠ è½½è¿›åº¦
        function updateLoadingProgress(percent) {
            const progressBar = document.getElementById('loadingProgress');
            if (progressBar) progressBar.style.width = `${percent}%`;
        }
        // ç¡®ä¿åŠ è½½åŠ¨ç”»æœ€ç»ˆä¼šéšè—ï¼ˆå…œåº•ï¼‰
        setTimeout(() => {
            const loadingEl = document.getElementById('global-loading');
            if (loadingEl && loadingEl.style.display !== 'none') {
                loadingEl.style.opacity = '0';
                setTimeout(() => { loadingEl.style.display = 'none'; }, 500);
            }
            const progressBar = document.getElementById('loadingProgress');
            if (progressBar) progressBar.style.display = 'none';
        }, 3000);

        // éŸ³ä¹æ’­æ”¾å™¨é«˜åº¦åŒæ­¥ï¼ˆä¸ä¸»é¡µé€»è¾‘ä¸€è‡´ï¼‰
        window.addEventListener('message', (e) => {
            if (e.data?.type === 'SONG_LIST_TOGGLED') {
                const iframe = document.getElementById('musicPlayerIframe');
                iframe.style.height = e.data.isShow ? '400px' : '110px';
            }
        });
    </script>
</body>
</html>
